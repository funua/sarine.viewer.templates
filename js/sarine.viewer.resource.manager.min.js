(function(){var n;n=function(){function t(){console.log("new singleton");f=new i;r=new u}var u,i,r,n,f;return n=void 0,f=void 0,r=void 0,t.getInstance=function(){return n===void 0&&(n=new this),n},u=function(){function n(){}return n.prototype.imageObj={},n.prototype.loadImage=function(n,t){var u,r,i;return i=this,this.imageObj[t.id]===void 0&&(this.imageObj[t.id]={capacity:t.downloadLimit||2,bag:[],threshhold:[]}),u=$.Deferred(),r=new Image,r.crossOrigin="Anonymous",r.onload=function(n){var u,f,r;return u=$.inArray(i.imageObj[t.id].threshhold.filter(function(){return function(t){return t.src===n.target.src}}(this))[0],i.imageObj[t.id].threshhold),f=i.imageObj[t.id].threshhold[u],r=i.imageObj[t.id].bag.shift(),r&&(r.img.src=r.src,i.imageObj[t.id].threshhold.push(r)),i.imageObj[t.id].threshhold.splice(u,1),f.defer.resolve(n.target)},this.imageObj[t.id].threshhold.length<this.imageObj[t.id].capacity?(this.imageObj[t.id].threshhold.push({defer:u,src:n,img:r}),r.src=n):this.imageObj[t.id].bag.push({defer:u,src:n,img:r}),u},n}(),t.prototype.loadImage=function(n){return r.loadImage(n,this)},i=function(){function t(){}var n;return n={},t.add=function(t,i,r){var u;return u={defer:i,item:r},n[t]||(setTimeout(function(t){var i,r;return i=n[t],n[t]=void 0,r=$.unique(i.map(function(n){return n.item.id})),i.forEach(function(n){return n.defer.resolve.apply(n.item)})},t,t),n[t]=[]),n[t].filter(function(n){return n.item.id===u.item.id}).length===0?n[t].push(u):void 0},t}(),t.prototype.setTimeout=function(n){var t;return t=$.Deferred(),i.add(n,t,this),t},t}();this.ResourceManager=n}).call(this);
//# sourceMappingURL=sarine.viewer.resource.manager.min.js.map
